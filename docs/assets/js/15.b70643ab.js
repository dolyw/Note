(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{450:function(t,r,s){"use strict";s.r(r);var e=s(20),_=Object(e.a)({},(function(){var t=this,r=t.$createElement,s=t._self._c||r;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"redis与数据库一致性补充"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis与数据库一致性补充"}},[t._v("#")]),t._v(" Redis与数据库一致性补充")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img13.360buyimg.com/img/jfs/t28360/131/684021377/198416/11cd412b/5bfa9e1aN8f399ede.jpg",alt:"图片"}})]),t._v(" "),s("p",[t._v("最近发现还有一种思路，在这里记录一下")]),t._v(" "),s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),s("p",[t._v("之前我们的操作都是这样")]),t._v(" "),s("ul",[s("li",[t._v("读取操作先从缓存取数据，没有，则从数据库中取数据，成功后，放到缓存中")]),t._v(" "),s("li",[t._v("更新操作就是操作数据库和缓存")])]),t._v(" "),s("p",[t._v("现在改成这样")]),t._v(" "),s("ul",[s("li",[t._v("读取操作先从缓存取数据，没有，则从数据库中取数据，"),s("strong",[t._v("成功后，不负责回写缓存")])]),t._v(" "),s("li",[t._v("更新操作就是更新数据库，删除缓存(或删除缓存，更新数据库)，"),s("strong",[t._v("发送缓存刷新消息")])]),t._v(" "),s("li",[s("strong",[t._v("然后有一个独立模块去消费消息，异步完成缓存刷新")])])]),t._v(" "),s("p",[t._v("还可以采用消费数据库Binlog的方式")]),t._v(" "),s("ul",[s("li",[t._v("读取操作先从缓存取数据，没有，则从数据库中取数据，"),s("strong",[t._v("成功后，不负责回写缓存")])]),t._v(" "),s("li",[t._v("更新操作就是更新数据库，删除缓存(或删除缓存，更新数据库)")]),t._v(" "),s("li",[s("strong",[t._v("然后有一个独立模块去消费数据库Binlog，异步完成缓存刷新")])])]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[s("strong",[t._v("感觉这样容易让出现读取操作Cache Miss，容易击穿DB，只是记录一下")])]),t._v(" "),s("p",[t._v("还有一种方式可以"),s("strong",[t._v("确保DB和Redis中缓存同一时间强一致")]),t._v("，使用了锁，性能吞吐量有下降，有兴趣可以看下: "),s("a",{attrs:{href:"https://mp.weixin.qq.com/s/Nc55ETgJB5Tb2g68ENKZOA",target:"_blank",rel:"noopener noreferrer"}},[t._v("聊聊db和缓存一致性常见的实现方式"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/hmBxNoQSHiWIWNa3WLzrfw",target:"_blank",rel:"noopener noreferrer"}},[t._v("漫画：要跳槽？这道缓存设计题你有必要看看！"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);r.default=_.exports}}]);